//
//  SvdTests.swift
//  MatLabSwiftTests
//
//  Created by Damien Noël Dubuisson on 02/11/2021.
//

import XCTest
@testable import MatLabSwift

class SvdTests: XCTestCase {
    func testSvd() throws {
        // Singular Values of Matrix
        let a = Matrix(array: [[1, 0, 1], [-1, -2, 0], [0, 1, -1,]])
//        XCTAssertEqual(MatLab.svd(a), Matrix(column: [2.4605, 1.6996, 0.2391]))
        XCTAssertEqual(MatLab.svd(a), [2.4605048700187635, 1.6996281482753182, 0.23912327825655447])
//        Eigenvectors Rendered:
//        −0.643
//        0.445
//        1,
//
//        −5.049
//        1.802
//        1,
//
//        −0.308
//        −1.247
//        1

        // Singular Value Decomposition
//        let b = Matrix(array: [[1, 2], [3, 4], [5, 6], [7, 8]])
//        let (u, s, v) = MatLab.svd(b)
//        XCTAssertEqual(u, Matrix(array: [[-0.1525, -0.8226, -0.3945, -0.3800],
//                                         [-0.3499, -0.4214, 0.2428, 0.8007],
//                                         [-0.5474, -0.0201, 0.6979, -0.4614],
//                                         [-0.7448, 0.3812, -0.5462, 0.0407]]))
//        XCTAssertEqual(s, Matrix(array: [[14.2691, 0.0],
//                                         [0.0, 0.6268],
//                                         [0.0, 0.0],
//                                         [0.0, 0.0]]))
//        XCTAssertEqual(v, Matrix(array: [[-0.6414, 0.7672], [-0.7672, -0.6414]]))
//        XCTAssertEqual(a.asDouble, u * s * v.transpose)

        let c: Matrix<Double> = MatLab.magic(6)
        let (uC, sC, vC) = MatLab.svd(c)
//        XCTAssertEqual(uC, Matrix(array: [[-0.4082, 0.5574, 0.0456, -0.4182, 0.3092, 0.5000],
//                                          [-0.4082, -0.2312, 0.6301, -0.2571, -0.5627, -0.0000],
//                                          [-0.4082, 0.4362, 0.2696, 0.5391, 0.1725, -0.5000],
//                                          [-0.4082, -0.3954, -0.2422, -0.4590, 0.3971, -0.5000],
//                                          [-0.4082, 0.1496, -0.6849, 0.0969, -0.5766, -0.0000],
//                                          [-0.4082, -0.5166, -0.0182, 0.4983, 0.2604, 0.5000]]))
        XCTAssertEqual(MatLab.diag(sC), Matrix(array: [[111.00000000000003, 0.0, 0.0, 0.0, 0.0, 0.0],
                                                       [0.0, 50.68021158106514, 0.0, 0.0, 0.0, 0.0],
                                                       [0.0, 0.0, 34.38392428115804, 0.0, 0.0, 0.0],
                                                       [0.0, 0.0, 0.0, 10.144874673132882, 0.0, 0.0],
                                                       [0.0, 0.0, 0.0, 0.0, 5.598519714396486, 0.0],
                                                       [0.0, 0.0, 0.0, 0.0, 0.0, 7.491678122404206e-16]]))
//        XCTAssertEqual(vC, Matrix(array: [[-0.4082, 0.6234, -0.3116, 0.2495, 0.2511, -0.4714],
//                                          [-0.4082, -0.6282, 0.3425, 0.1753, 0.2617, -0.4714],
//                                          [-0.4082, -0.4014, -0.7732, -0.0621, -0.1225, 0.2357],
//                                          [-0.4082, 0.1498, 0.2262, -0.4510, 0.5780, 0.4714],
//                                          [-0.4082, 0.1163, 0.2996, 0.6340, -0.3255, 0.4714],
//                                          [-0.4082, 0.1401, 0.2166, -0.5457, -0.6430, -0.2357]]))
        /*
         Eigenvectors Rendered:
         ⎛
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎝
         2
         2
         −
         1
         −
         2
         −
         2
         1
         ⎞
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎠
         ,
         ⎛
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎝
         8.83
         24.085
         −
         15.248
         25.078
         −
         43.745
         1
         ⎞
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎠
         ,
         ⎛
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎝
         −
         0.675
         −
         0.698
         0.122
         0.203
         0.048
         1
         ⎞
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎠
         ,
         ⎛
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎝
         −
         1
         2
         −
         1
         1
         −
         2
         1
         ⎞
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎠
         ,
         ⎛
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎝
         −
         1
         −
         1
         −
         1
         1
         1
         1
         ⎞
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎠
         ,
         ⎛
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎜
         ⎝
         1
         1
         1
         1
         1
         1
         ⎞
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎟
         ⎠
         */
    }
}
